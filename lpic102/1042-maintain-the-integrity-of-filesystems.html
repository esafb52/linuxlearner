
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="author" content="jadi" />
        <meta name="description" content="104.2 Maintain the integrity of filesystems Weight: 2 Candidates should be able to maintain a standard filesystem, as well as the extra data associated with a journaling filesystem. Objectives Verify the integrity of filesystems. Monitor free space and inodes. Repair simple filesystem problems. du df fsck e2fsck mke2fs debugfs â€¦" />


    <title>104.2 Maintain the integrity of filesystems - Linux Learner</title>

        <link rel="stylesheet" href="../theme/css/bootstrap.min.css" type="text/css" />

    <link href="../theme/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../theme/css/pygments/native.css" rel="stylesheet" />

    <link href="../theme/css/pelican-twitchy.min.css" rel="stylesheet" />

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Feeds -->
        <link href="../feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Linux Learner ATOM Feed" />
        <link href="../feeds/all.rss.xml" type="application/rss+xml" rel="alternate"
              title="Linux Learner RSS Feed" />
</head>
<body data-spy="scroll" data-target="#scrollspy">
    <div id="wrapper">
        <!-- Sidebar -->
        <div id="sidebar-wrapper-small" class="twitchy-background">
            <ul id="accordion-small" class="sidebar-nav sidebar-nav-small">
                <li>
        <a href=".." title="Linux Learner" class="collapsed">
            <span class="glyphicon glyphicon-home"></span>
        </a>
    </li>
                <li class="nav-divider"></li>
                <li>
        <a href="../archives.html" title="Recent Articles" class="collapsed">
            <span class="glyphicon glyphicon-th-list"></span>
        </a>
    </li>

                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion-small" href="#collapse-social-small" title="Social" class="collapsed">
                        <i class="fa fa-users padding-small"></i>
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-social-small" class="collapse ">
                    <li>
                        <a href="#" title="Another social link"><i class="fa fa-another-social-link-square fa-lg padding-small"></i></a>
                    </li>
                    <li>
                        <a href="#" title="You can add links in your config file"><i class="fa fa-you-can-add-links-in-your-config-file-square fa-lg padding-small"></i></a>
                    </li>
                </ul></li>
                <li class="nav-divider"></li>
                <li>
        <a href="#" title="Back to top" class="collapsed">
            <span class="fa fa-arrow-up"></span>
        </a>
    </li>
            </ul>
        </div>
        <div id="sidebar-wrapper" class="twitchy-background">
            <ul id="accordion" class="sidebar-nav">
                <li class="sidebar-brand">
                    <a href="../">
                            <span class="glyphicon glyphicon-home padding-small"></span>
                            Linux Learner
                    </a>
                </li>
                <li class="nav-divider"></li>
                <li>
                    <a  data-parent="#accordion" href="/pages/donate.html">
                        <span class="glyphicon glyphicon-heart padding-small"></span>
                        Support
                    </a>
                </li>

                    <li class="nav-divider"></li>
                    <li>
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapse-latest">
                            <span class="glyphicon glyphicon-th-list padding-small"></span>
                            LPIC1 Chapters
                        </a>
                    </li>
                    <li class="panel anti-panel"><ul id="collapse-latest" class="sidebar_submenu collapse in">
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1011-determine-and-configure-hardware-settings.html" title="101.1 Determine and configure hardware settings">
                                <i class="fa fa-file-text padding-small"></i>
                                101.1 Determine and configure hardware settings
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1012-boot-the-system.html" title="101.2. Boot the system">
                                <i class="fa fa-file-text padding-small"></i>
                                101.2. Boot the system
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1013-change-runlevels-and-shutdown-or-reboot-system.html" title="101.3. Change runlevels and shutdown or reboot system">
                                <i class="fa fa-file-text padding-small"></i>
                                101.3. Change runlevels and shutdown or reboot system
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1021-design-hard-disk-layout.html" title="102.1 Design hard disk layout">
                                <i class="fa fa-file-text padding-small"></i>
                                102.1 Design hard disk layout
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1022-install-a-boot-manager.html" title="102.2 Install a boot manager">
                                <i class="fa fa-file-text padding-small"></i>
                                102.2 Install a boot manager
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1023-manage-shared-libraries.html" title="102.3. Manage shared libraries">
                                <i class="fa fa-file-text padding-small"></i>
                                102.3. Manage shared libraries
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1024-use-debian-package-management.html" title="102.4. Use Debian package management">
                                <i class="fa fa-file-text padding-small"></i>
                                102.4. Use Debian package management
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1025-use-rpm-and-yum-package-management.html" title="102.5 Use RPM and YUM package management">
                                <i class="fa fa-file-text padding-small"></i>
                                102.5 Use RPM and YUM package management
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1031-work-on-the-command-line.html" title="103.1 Work on the command line">
                                <i class="fa fa-file-text padding-small"></i>
                                103.1 Work on the command line
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1032-process-text-streams-using-filters.html" title="103.2. Process text streams using filters">
                                <i class="fa fa-file-text padding-small"></i>
                                103.2. Process text streams using filters
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1033-perform-basic-file-management.html" title="103.3 Perform basic file management">
                                <i class="fa fa-file-text padding-small"></i>
                                103.3 Perform basic file management
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1034-use-streams-pipes-and-redirects.html" title="103.4. Use streams, pipes and redirects">
                                <i class="fa fa-file-text padding-small"></i>
                                103.4. Use streams, pipes and redirects
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1035-create-monitor-and-kill-processes.html" title="103.5. Create, monitor and kill processes">
                                <i class="fa fa-file-text padding-small"></i>
                                103.5. Create, monitor and kill processes
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1036-modify-process-execution-priorities.html" title="103.6. Modify process execution priorities">
                                <i class="fa fa-file-text padding-small"></i>
                                103.6. Modify process execution priorities
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1037-search-text-files-using-regular-expressions.html" title="103.7 Search text files using regular expressions">
                                <i class="fa fa-file-text padding-small"></i>
                                103.7 Search text files using regular expressions
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1038-perform-basic-file-editing-operations-using-vi.html" title="103.8 Perform basic file editing operations using vi">
                                <i class="fa fa-file-text padding-small"></i>
                                103.8 Perform basic file editing operations using vi
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1041-create-partitions-and-filesystems.html" title="104.1. Create partitions and filesystems">
                                <i class="fa fa-file-text padding-small"></i>
                                104.1. Create partitions and filesystems
                            </a>
                        </li>
                        <li class="active">
                            <a class="hide-overflow" href="../lpic102/1042-maintain-the-integrity-of-filesystems.html" title="104.2 Maintain the integrity of filesystems">
                                <i class="fa fa-file-text padding-small"></i>
                                104.2 Maintain the integrity of filesystems
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1043-control-mounting-and-unmounting-of-filesystems.html" title="104.3. Control mounting and unmounting of filesystems">
                                <i class="fa fa-file-text padding-small"></i>
                                104.3. Control mounting and unmounting of filesystems
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1044-manage-disk-quotas.html" title="104.4 Manage disk quotas">
                                <i class="fa fa-file-text padding-small"></i>
                                104.4 Manage disk quotas
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1045-manage-file-permissions-and-ownership.html" title="104.5 Manage file permissions and ownership">
                                <i class="fa fa-file-text padding-small"></i>
                                104.5 Manage file permissions and ownership
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1046-create-and-change-hard-symbolic-links.html" title="104.6. Create and change hard & symbolic links">
                                <i class="fa fa-file-text padding-small"></i>
                                104.6. Create and change hard & symbolic links
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1047-find-system-files-and-place-files-in-the-correct-location.html" title="104.7 Find system files and place files in the correct location">
                                <i class="fa fa-file-text padding-small"></i>
                                104.7 Find system files and place files in the correct location
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1051-customize-and-use-the-shell-environment.html" title="105.1. Customize and use the shell environment">
                                <i class="fa fa-file-text padding-small"></i>
                                105.1. Customize and use the shell environment
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1052-customize-or-write-simple-scripts.html" title="105.2 Customize or write simple scripts">
                                <i class="fa fa-file-text padding-small"></i>
                                105.2 Customize or write simple scripts
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1053-sql-data-management.html" title="105.3 SQL data management">
                                <i class="fa fa-file-text padding-small"></i>
                                105.3 SQL data management
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1061-install-and-configure-x11.html" title="106.1 Install and configure X11">
                                <i class="fa fa-file-text padding-small"></i>
                                106.1 Install and configure X11
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1062-setup-a-display-manager.html" title="106.2 Setup a display manager">
                                <i class="fa fa-file-text padding-small"></i>
                                106.2 Setup a display manager
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1063-accessibility.html" title="106.3 Accessibility">
                                <i class="fa fa-file-text padding-small"></i>
                                106.3 Accessibility
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1071-manage-user-and-group-accounts-and-related-system-files.html" title="107.1 Manage user and group accounts and related system files">
                                <i class="fa fa-file-text padding-small"></i>
                                107.1 Manage user and group accounts and related system files
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1072-automate-system-administration-tasks-by-scheduling-jobs.html" title="107.2 Automate system administration tasks by scheduling jobs">
                                <i class="fa fa-file-text padding-small"></i>
                                107.2 Automate system administration tasks by scheduling jobs
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1073-localisation-and-internationalisation.html" title="107.3 Localisation and internationalisation">
                                <i class="fa fa-file-text padding-small"></i>
                                107.3 Localisation and internationalisation
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1081-maintain-system-time.html" title="108.1 Maintain system time">
                                <i class="fa fa-file-text padding-small"></i>
                                108.1 Maintain system time
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1082-system-logging.html" title="108.2 System logging">
                                <i class="fa fa-file-text padding-small"></i>
                                108.2 System logging
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1083-mail-transfer-agent-mta-basics.html" title="108.3 Mail Transfer Agent (MTA) basics">
                                <i class="fa fa-file-text padding-small"></i>
                                108.3 Mail Transfer Agent (MTA) basics
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1084-manage-printers-and-printing.html" title="108.4 Manage printers and printing">
                                <i class="fa fa-file-text padding-small"></i>
                                108.4 Manage printers and printing
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1091-fundamentals-of-internet-protocols.html" title="109.1 Fundamentals of internet protocols">
                                <i class="fa fa-file-text padding-small"></i>
                                109.1 Fundamentals of internet protocols
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1092-basic-network-configuration.html" title="109.2 Basic network configuration">
                                <i class="fa fa-file-text padding-small"></i>
                                109.2 Basic network configuration
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1093-basic-network-troubleshooting.html" title="109.3 Basic network troubleshooting">
                                <i class="fa fa-file-text padding-small"></i>
                                109.3 Basic network troubleshooting
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1094-configure-client-side-dns.html" title="109.4 Configure client side DNS">
                                <i class="fa fa-file-text padding-small"></i>
                                109.4 Configure client side DNS
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1101-perform-security-administration-tasks.html" title="110.1 Perform security administration tasks">
                                <i class="fa fa-file-text padding-small"></i>
                                110.1 Perform security administration tasks
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1102-setup-host-security.html" title="110.2 Setup host security">
                                <i class="fa fa-file-text padding-small"></i>
                                110.2 Setup host security
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1103-securing-data-with-encryption.html" title="110.3 Securing data with encryption">
                                <i class="fa fa-file-text padding-small"></i>
                                110.3 Securing data with encryption
                            </a>
                        </li>
                    </ul></li>
                <li class="nav-divider"></li>
                <li>
                    <a  href="/pages/about.html">
                        <i class="fa fa-users padding-small"></i>
                        About Jadi
                    </a>
                </li>


                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse-categories">
                        <i class="fa fa-folder-open padding-small"></i>
                        Categories
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-categories" class="sidebar_submenu collapse ">
                    <li >
                        <a href="../category/lpic101.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            lpic101
                            <span class="badge pull-right categorybadge">16</span>
                        </a>
                    </li>
                    <li class="active">
                        <a href="../category/lpic102.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            lpic102
                            <span class="badge pull-right categorybadge">27</span>
                        </a>
                    </li>
                </ul></li>

            </ul>
        </div>
        <!-- /#sidebar-wrapper -->
        <!-- open/close sidebar -->
        <a href="#menu-toggle" class="btn btn-default" id="menu-toggle">
            <span id="right-arrow" class="glyphicon glyphicon-chevron-right"  title="expand sidebar"></span>
            <span id="left-arrow" class="glyphicon glyphicon-chevron-left" title="minimize sidebar"></span>
        </a>
       <!-- /open/close sidebar -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
<section id="content">
    <article>
        <div class="row">
            <div class="col-lg-9">
                <div class="entry-content">
                    <h1>104.2 Maintain the integrity of filesystems</h1>
<p><em>Weight: 2</em></p>
<p>Candidates should be able to maintain a standard filesystem, as well as the extra data associated with a journaling filesystem.</p>
<h1>Objectives</h1>
<ul>
<li>Verify the integrity of filesystems.</li>
<li>Monitor free space and inodes.</li>
<li>
<p>Repair simple filesystem problems.</p>
</li>
<li>
<p>du</p>
</li>
<li>df</li>
<li>fsck</li>
<li>e2fsck</li>
<li>mke2fs</li>
<li>debugfs</li>
<li>dumpe2fs</li>
<li>tune2fs</li>
<li>xfs tools</li>
</ul>
<h1>fsck</h1>
<p>If anything bad happens for your filesystem (say power suddenly goes down) you will have a corrupted file system. The command to fix this is <code>fsck</code>. Technically this command is a front end for many commands:</p>
<div class="highlight"><pre><span></span>jadi@funlife:~$ ls /sbin/*fsck*
/sbin/dosfsck      /sbin/fsck.ext2     /sbin/fsck.fat    /sbin/fsck.vfat
/sbin/e2fsck       /sbin/fsck.ext3     /sbin/fsck.minix
/sbin/fsck     /sbin/fsck.ext4     /sbin/fsck.msdos
/sbin/fsck.cramfs  /sbin/fsck.ext4dev  /sbin/fsck.nfs
</pre></div>


<blockquote>
<p>Some of these are just hardlinks to <code>e2fsck</code> command</p>
</blockquote>
<p>A common switch during boot is <code>-A</code> which tells fsck to check all file systems in /etc/fstab ordered by <em>passno</em> in that file which is 6th field (File systems with <em>passno</em> of 0, wont be checked during the boot.</p>
<div class="highlight"><pre><span></span>root@funlife:~# fsck /dev/sdb
fsck from util-linux 2.25.1
e2fsck 1.42.10 (18-May-2014)
/dev/sdb is in use.
e2fsck: Cannot continue, aborting.


root@funlife:~# umount /dev/sdb
umount: /dev/sdb: not mounted
root@funlife:~# umount /dev/sdb1
root@funlife:~# fsck /dev/sdb
fsck from util-linux 2.25.1
e2fsck 1.42.10 (18-May-2014)
ext2fs_open2: Bad magic number in super-block
fsck.ext2: Superblock invalid, trying backup blocks...
fsck.ext2: Bad magic number in super-block while trying to open /dev/sdb

The superblock could not be read or does not describe a valid ext2/ext3/ext4
filesystem.  If the device is valid and it really contains an ext2/ext3/ext4
filesystem (and not swap or ufs or something else), then the superblock
is corrupt, and you might try running e2fsck with an alternate superblock:
    e2fsck -b 8193 &lt;device&gt;
 or
    e2fsck -b 32768 &lt;device&gt;
</pre></div>


<p>You can also check filesystems with UUID (find them with <code>blkid</code> command or with labels):</p>
<div class="highlight"><pre><span></span>root@funlife:~# fsck /dev/sdb
fsck from util-linux 2.25.1
e2fsck 1.42.10 (18-May-2014)
ext2fs_open2: Bad magic number in super-block
fsck.ext2: Superblock invalid, trying backup blocks...
fsck.ext2: Bad magic number in super-block while trying to open /dev/sdb

The superblock could not be read or does not describe a valid ext2/ext3/ext4
filesystem.  If the device is valid and it really contains an ext2/ext3/ext4
filesystem (and not swap or ufs or something else), then the superblock
is corrupt, and you might try running e2fsck with an alternate superblock:
    e2fsck -b 8193 &lt;device&gt;
 or
    e2fsck -b 32768 &lt;device&gt;

root@funlife:~# blkid
/dev/sda1: LABEL=&quot;movies&quot;
/dev/sdb1: UUID=&quot;BA82-BECD&quot; TYPE=&quot;vfat&quot; PARTUUID=&quot;381add66-01&quot;
root@funlife:~# fsck LABEL=movies
fsck from util-linux 2.25.1
root@funlife:~# fsck UUID=&quot;BA82-BECD&quot;
fsck from util-linux 2.25.1
fsck.fat 3.0.26 (2014-03-07)
/dev/sdb1: 14 files, 1972/945094 clusters
</pre></div>


<p>You can use <code>-N</code> switch to see what command/test is going to be executed:</p>
<div class="highlight"><pre><span></span>root@funlife:~# fsck -N UUID=&quot;BA82-BECD&quot;
fsck from util-linux 2.25.1
[/sbin/fsck.vfat (1) -- /dev/sdb1] fsck.vfat /dev/sdb1
</pre></div>


<blockquote>
<p>If you want to check a XFS filesystem, you have to use <code>xfs_check</code> command</p>
</blockquote>
<h3>tune2fs</h3>
<p>This is a command to tune <em>ext</em> file systems. It can show information and set many options. The <code>-l</code> option lists the current configs:</p>
<div class="highlight"><pre><span></span>jadi@funlife:~$ sudo tune2fs -l /dev/sda2
tune2fs 1.42.10 (18-May-2014)
Filesystem volume name:   &lt;none&gt;
Last mounted on:          /
Filesystem UUID:          1651a94e-0b4e-47fb-aca0-f77e05714617
Filesystem magic number:  0xEF53
Filesystem revision #:    1 (dynamic)
Filesystem features:      has_journal ext_attr resize_inode dir_index filetype needs_recovery extent flex_bg sparse_super large_file huge_file uninit_bg dir_nlink extra_isize
Filesystem flags:         signed_directory_hash
Default mount options:    user_xattr acl
Filesystem state:         clean
Errors behavior:          Continue
Filesystem OS type:       Linux
Inode count:              1531904
Block count:              6123046
Reserved block count:     306152
Free blocks:              2302702
Free inodes:              1073461
First block:              0
Block size:               4096
Fragment size:            4096
Reserved GDT blocks:      1022
Blocks per group:         32768
Fragments per group:      32768
Inodes per group:         8192
Inode blocks per group:   512
Flex block group size:    16
Filesystem created:       Mon Dec  1 10:21:42 2014
Last mount time:          Sat Jan 31 17:21:51 2015
Last write time:          Sat Jan 31 17:21:51 2015
Mount count:              32
Maximum mount count:      -1
Last checked:             Mon Dec  1 10:21:42 2014
Check interval:           0 (&lt;none&gt;)
Lifetime writes:          103 GB
Reserved blocks uid:      0 (user root)
Reserved blocks gid:      0 (group root)
First inode:              11
Inode size:           256
Required extra isize:     28
Desired extra isize:      28
Journal inode:            8
First orphan inode:       786620
Default directory hash:   half_md4
Directory Hash Seed:      16c38a41-e709-4e04-b1c2-8a79d71ea7e8
Journal backup:           inode blocks
</pre></div>


<h3>xfs_info</h3>
<p>This is same as the <code>tune2fs</code> but for xfs file systems.</p>
<blockquote>
<p>xfs_info should be used on mounted file systems</p>
</blockquote>
<h1>du &amp; df</h1>
<p>In many cases you want to find out about the free space of a disk or find how much space a directory is using. This space can be used by the blocks of files or inodes.</p>
<blockquote>
<p>inodes contain the information about files. Information like the owner, when the last time it is used or edited, its size, if its a directory or not and peoples access rights on if. The inode number is unique within a particular filesystem and is also called files serial number.</p>
</blockquote>
<h2>df</h2>
<p>The DiskFree command is used to find out about the free and used space of file systems.</p>
<div class="highlight"><pre><span></span>jadi@funlife:~$ df -TH
Filesystem        Type      Size  Used Avail Use% Mounted on
/dev/sda2         ext4       23G   15G  7.7G  65% /
none              tmpfs     4.0K     0  4.0K   0% /sys/fs/cgroup
udev              devtmpfs  3.9G  4.0K  3.9G   1% /dev
tmpfs             tmpfs     788M  1.4M  786M   1% /run
none              tmpfs     5.0M  4.0K  5.0M   1% /run/lock
none              tmpfs     3.9G   19M  3.9G   1% /run/shm
none              tmpfs     100M   28K  100M   1% /run/user
/dev/mapper/chome ext4      243G  229G   14G  95% /home/jadi
/dev/sdb1         vfat      3.7G  7.8M  3.6G   1% /media/jadi/BA82-BECD
</pre></div>


<p>Here the <code>-T</code> switch make df to show the file system types and <code>-H</code> make numbers human readable (in powers of 1000). Please note that <code>-h</code> is also human readable but in powres of 1024 (e.g. shows 1k for 1000 bytes.</p>
<p>If you need the inode data, use the <code>-i</code> switch:</p>
<div class="highlight"><pre><span></span>jadi@funlife:~$ df -i
Filesystem          Inodes  IUsed    IFree IUse% Mounted on
/dev/sda2          1531904 458616  1073288   30% /
none               1007533      4  1007529    1% /sys/fs/cgroup
udev               1003703    542  1003161    1% /dev
tmpfs              1007533    644  1006889    1% /run
none               1007533      3  1007530    1% /run/lock
none               1007533    162  1007371    1% /run/shm
none               1007533     33  1007500    1% /run/user
/dev/mapper/chome 16171008 269293 15901715    2% /home/jadi
/dev/sdb1                0      0        0     - /media/jadi/BA82-BECD
</pre></div>


<blockquote>
<p>vfat file format has no inodes; there is no owner or access rights on vfat filesystems.</p>
</blockquote>
<h2>du</h2>
<p>The DiskUsage command give information about the used space of <strong>directories and files</strong>. The common switches are:</p>
<table>
<thead>
<tr>
<th>switch</th>
<th>usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>-h</td>
<td>print sizes in powers of 1024 (e.g., 1023M)</td>
</tr>
<tr>
<td>-H</td>
<td>print sizes in powers of 1000 (e.g., 1.1G)</td>
</tr>
<tr>
<td>-c</td>
<td>show the grand total</td>
</tr>
<tr>
<td>--max-depth 2</td>
<td>shows only 2 directories furthur</td>
</tr>
<tr>
<td>-s</td>
<td>Only shows the summary and not all the directories one by one</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span>jadi@funlife:~/w/lpic$ du
16  ./101
701456  ./done
701464  ./Logo/chert
704588  ./Logo
12  ./data
12  ./100
9432884 .
jadi@funlife:~/w/lpic$ du -c
16  ./101
701456  ./done
701464  ./Logo/chert
704588  ./Logo
12  ./data
12  ./100
9432884 .
9432884 total
jadi@funlife:~/w/lpic$ du -hs
9.0G    .
</pre></div>


<h1>Repairing</h1>
<p>We used the <code>fcsk</code> for showing file system information but if is designed to <em>fix</em> file systems too. If the boot time check find a problems, you will be put into a command line to fix the problems.</p>
<p>On non-journaling file systems (ext2) the fsck will show you many questions about each block and you have to say <code>y</code> if you want it to fix them. On journaling file systems (ext3&amp;4, xfs, ..) the fsck has much less tasks to perform.</p>
<blockquote>
<p>for xfs file systems, we have <code>xfs_check</code> command</p>
</blockquote>
<p>An important switch is <code>-n</code> which causes these commands <strong>not to fix</strong> anything and just show what was going to be done.</p>
<h2>debugfs</h2>
<p>This is an interactive tool for debug an ext filesystem. It opens the filesystem in read-only mode unless we tell it not to (with <code>-w</code> option). It can un-delete files and directories..</p>
<div class="highlight"><pre><span></span>root@funlife:~# debugfs /dev/sda2
debugfs 1.42.10 (18-May-2014)
debugfs:  cd /etc/      &lt;-- cd
debugfs:  pwd           &lt;-- show were am I
[pwd]   INODE: 524289  PATH: /etc
[root]  INODE:      2  PATH: /
debugfs:  stat passwd       &lt;-- show data on one file
Inode: 527187   Type: regular    Mode:  0644   Flags: 0x80000
Generation: 1875144872    Version: 0x00000000:00000001
User:     0   Group:     0   Size: 2145
File ACL: 0    Directory ACL: 0
Links: 1   Blockcount: 8
Fragment:  Address: 0    Number: 0    Size: 0
 ctime: 0x548d4241:a7b196fc -- Sun Dec 14 11:24:41 2014
 atime: 0x54cc635b:6acfc148 -- Sat Jan 31 08:38:43 2015
 mtime: 0x548d4241:a01076f8 -- Sun Dec 14 11:24:41 2014
crtime: 0x548d4241:9f1c52f8 -- Sun Dec 14 11:24:41 2014
Size of extra inode fields: 28
EXTENTS:
(0):2188172
debugfs:  ncheck 527187     &lt;-- node check an inode
Inode   Pathname        
527187  /etc/passwd
debugfs:  q         &lt;-- quit
</pre></div>


<h1>Superblock</h1>
<p>Unix systems use superblocks to save <em>filesystem metadata</em>. Most of the times this block is located at the beginning of the file system and replicated on other locations too. The <code>-n</code> of <code>mke2fs</code> displays superblock locations</p>
<div class="highlight"><pre><span></span># mke2fs -n /dev/sda7
mke2fs 1.41.9 (22-Aug-2009)
Filesystem label=
OS type: Linux
Block size=4096 (log=2)
Fragment size=4096 (log=2)
7159808 inodes, 28637862 blocks
1431893 blocks (5.00%) reserved for the super user
First data block=0
Maximum filesystem blocks=4294967296
874 block groups
32768 blocks per group, 32768 fragments per group
8192 inodes per group
Superblock backups stored on blocks:
    32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208,
    4096000, 7962624, 11239424, 20480000, 23887872
</pre></div>


<h1>Other tools</h1>
<p>For the LPIC exam, it is good to know about these commands.</p>
<table>
<thead>
<tr>
<th>filesystem</th>
<th>command</th>
<th>usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>ext</td>
<td>tune2fs</td>
<td>Show or set ext2 and ext3 parameters or even set the journaling options</td>
</tr>
<tr>
<td>ext</td>
<td>dumpe2fs</td>
<td>Prints the super block and block group descriptor information for an ext2 or ext3 filesystem.</td>
</tr>
<tr>
<td>ext</td>
<td>debugfs</td>
<td>Is an interactive file system debugger. Use it to examine or change the state of an ext2 or ext3file system.</td>
</tr>
<tr>
<td>reiserfs</td>
<td>reiserfstune</td>
<td>show and set parameters</td>
</tr>
<tr>
<td>reiserfs</td>
<td>debugreiserfs</td>
<td>Prints the super block and block group descriptor information for an ext2 or ext3 filesystem.</td>
</tr>
<tr>
<td>XFS</td>
<td>xfs_info</td>
<td>display information</td>
</tr>
<tr>
<td>XFS</td>
<td>xfs_growfs</td>
<td>expand file system</td>
</tr>
<tr>
<td>XFS</td>
<td>xfs_admin</td>
<td>change parameters on XFS file systems</td>
</tr>
<tr>
<td>XFS</td>
<td>xfs_repair</td>
<td>repair the problems</td>
</tr>
<tr>
<td>XFS</td>
<td>xfs_db</td>
<td>checks and debugs the filesystem</td>
</tr>
</tbody>
</table>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
                </div>
                <footer class="text-right">
                    <p></p>
                </footer>
            </div>
        </div>
    </article>
</section>
<footer>
    <hr>
    <div class="row">
        <div class="col-lg-9 text-center">
            <p><small>
                Built by <a href="http://docs.getpelican.com/en/latest">Pelican</a> / <a href="https://github.com/ingwinlu/pelican-twitchy">pelican-twitchy</a>
                &middot;                    &copy; 2015 jadi
            </small></p>
        </div>
    </div>
</footer>            </div>
        </div>
        <!-- /#page-content-wrapper -->
    </div>
    <!-- /#wrapper -->
    <!-- jQuery Version 1.11.2 -->
    <script src="../theme/js/jquery-1.11.2.min.js"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="../theme/js/bootstrap.min.js"></script>
    <!-- twitchy Script -->
    <script src="../theme/js/pelican_twitchy.min.js"></script>

</body>
</html>