
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="author" content="jadi" />
        <meta name="description" content="110.1 Perform security administration tasks Weight: 3 Candidates should know how to review system configuration to ensure host security in accordance with local security policies. Key Knowledge Areas Audit a system to find files with the suid/sgid bit set. Set or change user passwords and password aging information â€¦" />


    <title>110.1 Perform security administration tasks - Linux Learner</title>

        <link rel="stylesheet" href="../theme/css/bootstrap.min.css" type="text/css" />

    <link href="../theme/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../theme/css/pygments/native.css" rel="stylesheet" />

    <link href="../theme/css/pelican-twitchy.min.css" rel="stylesheet" />

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Feeds -->
        <link href="../feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Linux Learner ATOM Feed" />
        <link href="../feeds/all.rss.xml" type="application/rss+xml" rel="alternate"
              title="Linux Learner RSS Feed" />
</head>
<body data-spy="scroll" data-target="#scrollspy">
    <div id="wrapper">
        <!-- Sidebar -->
        <div id="sidebar-wrapper-small" class="twitchy-background">
            <ul id="accordion-small" class="sidebar-nav sidebar-nav-small">
                <li>
        <a href=".." title="Linux Learner" class="collapsed">
            <span class="glyphicon glyphicon-home"></span>
        </a>
    </li>
                <li class="nav-divider"></li>
                <li>
        <a href="../archives.html" title="Recent Articles" class="collapsed">
            <span class="glyphicon glyphicon-th-list"></span>
        </a>
    </li>

                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion-small" href="#collapse-social-small" title="Social" class="collapsed">
                        <i class="fa fa-users padding-small"></i>
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-social-small" class="collapse ">
                    <li>
                        <a href="#" title="Another social link"><i class="fa fa-another-social-link-square fa-lg padding-small"></i></a>
                    </li>
                    <li>
                        <a href="#" title="You can add links in your config file"><i class="fa fa-you-can-add-links-in-your-config-file-square fa-lg padding-small"></i></a>
                    </li>
                </ul></li>
                <li class="nav-divider"></li>
                <li>
        <a href="#" title="Back to top" class="collapsed">
            <span class="fa fa-arrow-up"></span>
        </a>
    </li>
            </ul>
        </div>
        <div id="sidebar-wrapper" class="twitchy-background">
            <ul id="accordion" class="sidebar-nav">
                <li class="sidebar-brand">
                    <a href="../">
                            <span class="glyphicon glyphicon-home padding-small"></span>
                            Linux Learner
                    </a>
                </li>
                <li class="nav-divider"></li>
                <li>
                    <a  data-parent="#accordion" href="/pages/donate.html">
                        <span class="glyphicon glyphicon-heart padding-small"></span>
                        Support
                    </a>
                </li>

                    <li class="nav-divider"></li>
                    <li>
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapse-latest">
                            <span class="glyphicon glyphicon-th-list padding-small"></span>
                            LPIC1 Chapters
                        </a>
                    </li>
                    <li class="panel anti-panel"><ul id="collapse-latest" class="sidebar_submenu collapse in">
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1011-determine-and-configure-hardware-settings.html" title="101.1 Determine and configure hardware settings">
                                <i class="fa fa-file-text padding-small"></i>
                                101.1 Determine and configure hardware settings
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1012-boot-the-system.html" title="101.2. Boot the system">
                                <i class="fa fa-file-text padding-small"></i>
                                101.2. Boot the system
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1013-change-runlevels-and-shutdown-or-reboot-system.html" title="101.3. Change runlevels and shutdown or reboot system">
                                <i class="fa fa-file-text padding-small"></i>
                                101.3. Change runlevels and shutdown or reboot system
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1021-design-hard-disk-layout.html" title="102.1 Design hard disk layout">
                                <i class="fa fa-file-text padding-small"></i>
                                102.1 Design hard disk layout
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1022-install-a-boot-manager.html" title="102.2 Install a boot manager">
                                <i class="fa fa-file-text padding-small"></i>
                                102.2 Install a boot manager
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1023-manage-shared-libraries.html" title="102.3. Manage shared libraries">
                                <i class="fa fa-file-text padding-small"></i>
                                102.3. Manage shared libraries
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1024-use-debian-package-management.html" title="102.4. Use Debian package management">
                                <i class="fa fa-file-text padding-small"></i>
                                102.4. Use Debian package management
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1025-use-rpm-and-yum-package-management.html" title="102.5 Use RPM and YUM package management">
                                <i class="fa fa-file-text padding-small"></i>
                                102.5 Use RPM and YUM package management
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1031-work-on-the-command-line.html" title="103.1 Work on the command line">
                                <i class="fa fa-file-text padding-small"></i>
                                103.1 Work on the command line
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1032-process-text-streams-using-filters.html" title="103.2. Process text streams using filters">
                                <i class="fa fa-file-text padding-small"></i>
                                103.2. Process text streams using filters
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1033-perform-basic-file-management.html" title="103.3 Perform basic file management">
                                <i class="fa fa-file-text padding-small"></i>
                                103.3 Perform basic file management
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1034-use-streams-pipes-and-redirects.html" title="103.4. Use streams, pipes and redirects">
                                <i class="fa fa-file-text padding-small"></i>
                                103.4. Use streams, pipes and redirects
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1035-create-monitor-and-kill-processes.html" title="103.5. Create, monitor and kill processes">
                                <i class="fa fa-file-text padding-small"></i>
                                103.5. Create, monitor and kill processes
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1036-modify-process-execution-priorities.html" title="103.6. Modify process execution priorities">
                                <i class="fa fa-file-text padding-small"></i>
                                103.6. Modify process execution priorities
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1037-search-text-files-using-regular-expressions.html" title="103.7 Search text files using regular expressions">
                                <i class="fa fa-file-text padding-small"></i>
                                103.7 Search text files using regular expressions
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic101/1038-perform-basic-file-editing-operations-using-vi.html" title="103.8 Perform basic file editing operations using vi">
                                <i class="fa fa-file-text padding-small"></i>
                                103.8 Perform basic file editing operations using vi
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1041-create-partitions-and-filesystems.html" title="104.1. Create partitions and filesystems">
                                <i class="fa fa-file-text padding-small"></i>
                                104.1. Create partitions and filesystems
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1042-maintain-the-integrity-of-filesystems.html" title="104.2 Maintain the integrity of filesystems">
                                <i class="fa fa-file-text padding-small"></i>
                                104.2 Maintain the integrity of filesystems
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1043-control-mounting-and-unmounting-of-filesystems.html" title="104.3. Control mounting and unmounting of filesystems">
                                <i class="fa fa-file-text padding-small"></i>
                                104.3. Control mounting and unmounting of filesystems
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1044-manage-disk-quotas.html" title="104.4 Manage disk quotas">
                                <i class="fa fa-file-text padding-small"></i>
                                104.4 Manage disk quotas
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1045-manage-file-permissions-and-ownership.html" title="104.5 Manage file permissions and ownership">
                                <i class="fa fa-file-text padding-small"></i>
                                104.5 Manage file permissions and ownership
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1046-create-and-change-hard-symbolic-links.html" title="104.6. Create and change hard & symbolic links">
                                <i class="fa fa-file-text padding-small"></i>
                                104.6. Create and change hard & symbolic links
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1047-find-system-files-and-place-files-in-the-correct-location.html" title="104.7 Find system files and place files in the correct location">
                                <i class="fa fa-file-text padding-small"></i>
                                104.7 Find system files and place files in the correct location
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1051-customize-and-use-the-shell-environment.html" title="105.1. Customize and use the shell environment">
                                <i class="fa fa-file-text padding-small"></i>
                                105.1. Customize and use the shell environment
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1052-customize-or-write-simple-scripts.html" title="105.2 Customize or write simple scripts">
                                <i class="fa fa-file-text padding-small"></i>
                                105.2 Customize or write simple scripts
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1053-sql-data-management.html" title="105.3 SQL data management">
                                <i class="fa fa-file-text padding-small"></i>
                                105.3 SQL data management
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1061-install-and-configure-x11.html" title="106.1 Install and configure X11">
                                <i class="fa fa-file-text padding-small"></i>
                                106.1 Install and configure X11
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1062-setup-a-display-manager.html" title="106.2 Setup a display manager">
                                <i class="fa fa-file-text padding-small"></i>
                                106.2 Setup a display manager
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1063-accessibility.html" title="106.3 Accessibility">
                                <i class="fa fa-file-text padding-small"></i>
                                106.3 Accessibility
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1071-manage-user-and-group-accounts-and-related-system-files.html" title="107.1 Manage user and group accounts and related system files">
                                <i class="fa fa-file-text padding-small"></i>
                                107.1 Manage user and group accounts and related system files
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1072-automate-system-administration-tasks-by-scheduling-jobs.html" title="107.2 Automate system administration tasks by scheduling jobs">
                                <i class="fa fa-file-text padding-small"></i>
                                107.2 Automate system administration tasks by scheduling jobs
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1073-localisation-and-internationalisation.html" title="107.3 Localisation and internationalisation">
                                <i class="fa fa-file-text padding-small"></i>
                                107.3 Localisation and internationalisation
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1081-maintain-system-time.html" title="108.1 Maintain system time">
                                <i class="fa fa-file-text padding-small"></i>
                                108.1 Maintain system time
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1082-system-logging.html" title="108.2 System logging">
                                <i class="fa fa-file-text padding-small"></i>
                                108.2 System logging
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1083-mail-transfer-agent-mta-basics.html" title="108.3 Mail Transfer Agent (MTA) basics">
                                <i class="fa fa-file-text padding-small"></i>
                                108.3 Mail Transfer Agent (MTA) basics
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1084-manage-printers-and-printing.html" title="108.4 Manage printers and printing">
                                <i class="fa fa-file-text padding-small"></i>
                                108.4 Manage printers and printing
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1091-fundamentals-of-internet-protocols.html" title="109.1 Fundamentals of internet protocols">
                                <i class="fa fa-file-text padding-small"></i>
                                109.1 Fundamentals of internet protocols
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1092-basic-network-configuration.html" title="109.2 Basic network configuration">
                                <i class="fa fa-file-text padding-small"></i>
                                109.2 Basic network configuration
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1093-basic-network-troubleshooting.html" title="109.3 Basic network troubleshooting">
                                <i class="fa fa-file-text padding-small"></i>
                                109.3 Basic network troubleshooting
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1094-configure-client-side-dns.html" title="109.4 Configure client side DNS">
                                <i class="fa fa-file-text padding-small"></i>
                                109.4 Configure client side DNS
                            </a>
                        </li>
                        <li class="active">
                            <a class="hide-overflow" href="../lpic102/1101-perform-security-administration-tasks.html" title="110.1 Perform security administration tasks">
                                <i class="fa fa-file-text padding-small"></i>
                                110.1 Perform security administration tasks
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1102-setup-host-security.html" title="110.2 Setup host security">
                                <i class="fa fa-file-text padding-small"></i>
                                110.2 Setup host security
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="../lpic102/1103-securing-data-with-encryption.html" title="110.3 Securing data with encryption">
                                <i class="fa fa-file-text padding-small"></i>
                                110.3 Securing data with encryption
                            </a>
                        </li>
                    </ul></li>
                <li class="nav-divider"></li>
                <li>
                    <a  href="/pages/about.html">
                        <i class="fa fa-users padding-small"></i>
                        About Jadi
                    </a>
                </li>


                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse-categories">
                        <i class="fa fa-folder-open padding-small"></i>
                        Categories
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-categories" class="sidebar_submenu collapse ">
                    <li >
                        <a href="../category/lpic101.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            lpic101
                            <span class="badge pull-right categorybadge">16</span>
                        </a>
                    </li>
                    <li class="active">
                        <a href="../category/lpic102.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            lpic102
                            <span class="badge pull-right categorybadge">27</span>
                        </a>
                    </li>
                </ul></li>

            </ul>
        </div>
        <!-- /#sidebar-wrapper -->
        <!-- open/close sidebar -->
        <a href="#menu-toggle" class="btn btn-default" id="menu-toggle">
            <span id="right-arrow" class="glyphicon glyphicon-chevron-right"  title="expand sidebar"></span>
            <span id="left-arrow" class="glyphicon glyphicon-chevron-left" title="minimize sidebar"></span>
        </a>
       <!-- /open/close sidebar -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
<section id="content">
    <article>
        <div class="row">
            <div class="col-lg-9">
                <div class="entry-content">
                    <h1>110.1 Perform security administration tasks</h1>
<p><em>Weight: 3</em></p>
<p>Candidates should know how to review system configuration to ensure host security in accordance with local security policies.</p>
<h2>Key Knowledge Areas</h2>
<ul>
<li>Audit a system to find files with the suid/sgid bit set.</li>
<li>Set or change user passwords and password aging information.</li>
<li>Being able to use nmap and netstat to discover open ports on a system.</li>
<li>Set up limits on user logins, processes and memory usage.</li>
<li>Determine which users have logged in to the system or are currently logged in.</li>
<li>Basic sudo configuration and usage.</li>
</ul>
<h2>Terms and Utilities</h2>
<ul>
<li>find</li>
<li>passwd</li>
<li>fuser</li>
<li>lsof</li>
<li>nmap</li>
<li>chage</li>
<li>netstat</li>
<li>sudo</li>
<li>/etc/sudoers</li>
<li>su</li>
<li>usermod</li>
<li>ulimit</li>
<li>who, w, last</li>
</ul>
<h3>suid and guid</h3>
<p>We've already covered <code>suid</code>. When the suid bit is set on an executable file, whoever runs the file, is running the file with the access of the owner of the file. Have a look at the <code>ping</code> command:</p>
<div class="highlight"><pre><span></span>jadi@funlife ~$ type ping
ping is hashed (/bin/ping)
jadi@funlife ~$ ls -ltrh /bin/ping
-rwsr-xr-x 1 root root 44K May  8  2014 /bin/ping
</pre></div>


<p>The <code>s</code> on the access rights part, tells us that whoever runs the ping command, the ping command will be run with root access. This is neede by root and is OK on my distro but what happens if someone changes the suid of the vi command? lets see who own vi:</p>
<div class="highlight"><pre><span></span>jadi@funlife ~$ type vi
vi is /usr/bin/vi
jadi@funlife ~$ ls -ltrh /usr/bin/vi
lrwxrwxrwx 1 root root 20 Jun  1 12:52 /usr/bin/vi -&gt; /etc/alternatives/vi
</pre></div>


<p>at the moment, the <code>vi</code> is owned by root,  so if the suid bit is set, vi will always be run as root! In that case anybody will be able to edit any file! You can see why it is important to check for suid files on your system:</p>
<div class="highlight"><pre><span></span>$sudo find / -perm -u+s
</pre></div>


<blockquote>
<p>same applies for guid. if the guid is set, the file will be run with access of its group</p>
</blockquote>
<h3>Open Ports</h3>
<h4>netstat, fuser and lsof</h4>
<p>On module 109.1 we talked about ports, ports are like wholes in our systems used by servers to listen to the outside world. If I'm running a web server on my computer I should have a port open so people can ask that server "please show me your index.html". Many malwares open ports to let the attacker to communicate with them. It is important to check your computer for open ports time to time. The main command for this task is <code>netstat</code> using the <code>-na</code> or <code>-ap</code> or <code>-tuna</code> switch.. I'm sure tuna is easy to remember if you have the tuna fish in mind!</p>
<div class="highlight"><pre><span></span>jadi@funlife ~$ netstat -tuna
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State      
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN     
tcp        0      0 127.0.1.1:53            0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:9050          0.0.0.0:*               LISTEN     
tcp       25      0 192.168.59.9:49934      192.168.59.192:139      CLOSE_WAIT
tcp        0      0 127.0.0.1:60228         127.0.0.1:1080          ESTABLISHED
tcp        0      0 192.168.1.35:55324      159.203.148.169:8385    ESTABLISHED
tcp        0      0 127.0.0.1:59590         127.0.0.1:1080          ESTABLISHED
tcp        0      0 127.0.0.1:60212         127.0.0.1:1080          ESTABLISHED
tcp        0      0 192.168.1.35:54220      159.203.148.169:8385    ESTABLISHED
tcp        0      0 127.0.0.1:57186         127.0.0.1:1080          ESTABLISHED
tcp        0      0 192.168.1.35:49574      173.194.122.231:443     ESTABLISHED
tcp        0      0 127.0.0.1:59002         127.0.0.1:1080          ESTABLISHED
udp        0      0 0.0.0.0:54502           0.0.0.0:*                          
udp        0      0 0.0.0.0:5353            0.0.0.0:*                          
udp        0      0 0.0.0.0:5353            0.0.0.0:*         
</pre></div>


<p>All the <code>LISTEN</code> ports are servers; they are LISTENING for new incoming connections. The <code>ESTABLISHED</code> connections are the active connections between your computer and another computer. In these tables <code>0.0.0.0</code> dictates <em>any address</em> or <em>any interface</em>.</p>
<p>Another useful tool here is <code>lsof</code> and <code>fuser</code>. The former is already discussed in previous sections. <code>lsof</code> shows the open files on the system and having in mind that <em>everything in Linux is a file or a process</em> you can conclude that this command should be able to display open connections too; and you are right:</p>
<div class="highlight"><pre><span></span># lsof -i
COMMAND     PID       USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
privoxy     806    privoxy    4u  IPv4   16130      0t0  TCP funlife:8118 (LISTEN)
cups-brow   903       root    8u  IPv4   17477      0t0  UDP *:ipp
mysqld      971      mysql   19u  IPv4   20875      0t0  TCP funlife:mysql (LISTEN)
tor        1038 debian-tor    6u  IPv4   19155      0t0  TCP funlife:9050 (LISTEN)
dnsmasq    1260     nobody   11u  IPv4 1910037      0t0  UDP *:18666
adb        1278       jadi    5u  IPv4  579541      0t0  TCP funlife:5037 (LISTEN)
chromium-  2891       jadi   88u  IPv4  813611      0t0  TCP 192.168.1.35:45702-&gt;do-13.lastpass.com:https (ESTABLISHED)
chromium-  2891       jadi  126u  IPv4 1907389      0t0  TCP 192.168.1.35:50642-&gt;ntt-2.lastpass.com:https (ESTABLISHED)
chromium-  2891       jadi  133u  IPv4 1909733      0t0  TCP 192.168.1.35:50644-&gt;ntt-2.lastpass.com:https (ESTABLISHED)
chromium-  2891       jadi  268u  IPv4  785289      0t0  TCP 192.168.1.35:60736-&gt;lf-in-f188.1e100.net:5228 (ESTABLISHED)
python     4925       jadi    4u  IPv4  658287      0t0  TCP funlife:8000 (LISTEN)
Telegram   4943       jadi   39u  IPv4  773463      0t0  TCP 192.168.1.35:44732-&gt;149.154.175.50:https (ESTABLISHED)
dhclient   9984       root    6u  IPv4  787885      0t0  UDP *:bootpc
nginx     11095       root    6u  IPv4   17998      0t0  TCP *:http (LISTEN)
nginx     11099   www-data    7u  IPv6   17999      0t0  TCP *:http (LISTEN)
chrome    14264       jadi  114u  IPv4  788089      0t0  UDP *:mdns
chrome    14264       jadi  126u  IPv4 1872872      0t0  TCP funlife:60370-&gt;funlife:socks (ESTABLISHED)
chrome    14264       jadi  138u  IPv4 1908382      0t0  TCP funlife:60408-&gt;funlife:socks (ESTABLISHED)
</pre></div>


<p>Wow! this command shows the command, PID, user running it and source and destination IP and tells of if this is a LISTENING or STABLISHED connection.</p>
<p>If you want to check which process is using port 80, you can grep the output of any above commands or simply use the <code>fuser</code> command to find all the PIDs related to that specific port:</p>
<div class="highlight"><pre><span></span>root@funlife:/bin# fuser 80/tcp
80/tcp:              11095 11096 11097 11098 11099
</pre></div>


<h4>nmap</h4>
<p><code>nmap</code> is the toolbox of hackers! You can nmap a server to find out about a lot of data about that server:</p>
<div class="highlight"><pre><span></span># nmap localhost

Starting Nmap 7.01 ( https://nmap.org ) at 2016-06-04 21:32 IRDT
Nmap scan report for localhost (127.0.0.1)
Host is up (0.0000070s latency).
rDNS record for 127.0.0.1: funlife
Not shown: 995 closed ports
PORT     STATE SERVICE
80/tcp   open  http
1080/tcp open  socks
3306/tcp open  mysql
8000/tcp open  http-alt
9050/tcp open  tor-socks

Nmap done: 1 IP address (1 host up) scanned in 1.66 seconds
root@funlife:~#
</pre></div>


<p>In the most basic form, nmap checks all the open ports from 1 to 1000 and prints the results. There are a lot of switches to find other information about the hosts and they are used by every single hacker who wants to examine a servers status.</p>
<h3>sudo vs su</h3>
<p>We've used sudo and su in all the chapters and this is time to have a closer look at them! <code>su</code> changes your account to something else. You get a new prompt with the new user account after successfully <code>su</code>ing to that account:</p>
<div class="highlight"><pre><span></span>jadi@funlife ~$ whoami
jadi
jadi@funlife ~$ su -
Password:
root@funlife:~# whoami
root
root@funlife:~# su jadi -
bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
jadi@funlife /root$ whoami
jadi
jadi@funlife /root$ exit
exit
root@funlife:~# whoami
root
root@funlife:~# exit
logout
jadi@funlife ~$ whoami
jadi
jadi@funlife ~$
</pre></div>


<p>Note that when running <code>su</code> you have to <strong>provide the root password</strong> to become root; or any other users password to become that user!</p>
<p>On the other hand, sudo asks for you own password and runs the command you gave it, with the root privileges. So <code>sudo ls</code> runs the ls command with the root privileges after asking for <strong>your passowrd</strong>.  Obviously you should have the <em>sudo right</em> to issue sudo. This is defined in /etc/sudoers file:</p>
<div class="highlight"><pre><span></span><span class="err">$</span> <span class="n">sudo</span> <span class="n">cat</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sudoers</span>
<span class="cp">#</span>
<span class="cp"># This file MUST be edited with the &#39;visudo&#39; command as root.</span>
<span class="cp">#</span>
<span class="cp"># Please consider adding local content in /etc/sudoers.d/ instead of</span>
<span class="cp"># directly modifying this file.</span>
<span class="cp">#</span>
<span class="cp"># See the man page for details on how to write a sudoers file.</span>
<span class="cp">#</span>
<span class="n">Defaults</span>    <span class="n">env_reset</span>
<span class="n">Defaults</span>    <span class="n">mail_badpass</span>
<span class="n">Defaults</span>    <span class="n">secure_path</span><span class="o">=</span><span class="s">&quot;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>

<span class="cp"># Host alias specification</span>

<span class="cp"># User alias specification</span>

<span class="cp"># Cmnd alias specification</span>

<span class="cp"># User privilege specification</span>
<span class="n">root</span>    <span class="n">ALL</span><span class="o">=</span><span class="p">(</span><span class="nl">ALL</span><span class="p">:</span><span class="n">ALL</span><span class="p">)</span> <span class="n">ALL</span>

<span class="cp"># Members of the admin group may gain root privileges</span>
<span class="nf">%admin</span> <span class="n">ALL</span><span class="o">=</span><span class="p">(</span><span class="n">ALL</span><span class="p">)</span> <span class="n">ALL</span>

<span class="cp"># Allow members of group sudo to execute any command</span>
<span class="nf">%sudo</span>   <span class="n">ALL</span><span class="o">=</span><span class="p">(</span><span class="nl">ALL</span><span class="p">:</span><span class="n">ALL</span><span class="p">)</span> <span class="n">ALL</span>

<span class="cp"># See sudoers(5) for more information on &quot;#include&quot; directives:</span>

<span class="cp">#include</span><span class="cpf">dir /etc/sudoers.d</span><span class="cp"></span>
</pre></div>


<p>note the 2 important lines: how root gets the right to run all the commands and how the sudo and admin groups get rights to run commands as root. The <code>ALL:ALL</code> means these users can run as any use and any group. The last ALL tells the sudo that these users / groups can run ALL commands. It is possible to put /bin/ping in the last part to tell sudo that this user can run only ping as root.</p>
<blockquote>
<p>The /etc/sudoers file is very important and breaking it will make major problems. to prevent you from adding un-interpretable lines in that file, the <code>visudo</code> command should be used instead of <code>vi /etc/sudoers</code>. This tool will check your edits to make sure that sudo command can understand them.</p>
</blockquote>
<p>Now we know what <code>sudo su -</code> means. The sudo tells the system to run the <code>su -</code> command with the root access. It asks your password and runs the <code>su -</code> as the root if you have sudo access. The <code>su</code> commands changes your user to root and <code>-</code> switch load the root environment variables. This way you can become root using your own password via running <code>su</code> with <code>sudo</code>.</p>
<h3>user limits</h3>
<p>The resources on a Linux machine can be manages for users by the <code>ulimit</code> command. It is part of the PAM system. If you want to check the limits on the system run:</p>
<div class="highlight"><pre><span></span>~$ ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 47457
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 47457
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
</pre></div>


<p>and you can change them like this:</p>
<div class="highlight"><pre><span></span>$ <span class="nb">ulimit</span> -t <span class="m">1</span>
</pre></div>


<p>This will limit the CPU TIME of any process to 1 seconds. If you use more than that, the process will be killed automatically (by PAM module). Please note that clock time is different than CPU time. To see how much CPU time a process uses run it like this:</p>
<div class="highlight"><pre><span></span>$ <span class="nb">time</span> firefox
</pre></div>


<p>Changing the ulimit as we did is a temporary thing. It only persists in that specific shell.</p>
<p>To change the ulimits system-wide:</p>
<div class="highlight"><pre><span></span>$ cat /etc/security/limits.conf
<span class="c1"># /etc/security/limits.conf</span>
<span class="c1">#</span>
<span class="c1">#Each line describes a limit for a user in the form:</span>
<span class="c1">#</span>
<span class="c1">#&lt;domain&gt;        &lt;type&gt;  &lt;item&gt;  &lt;value&gt;</span>
<span class="c1">#</span>
<span class="c1">#Where:</span>
<span class="c1">#&lt;domain&gt; can be:</span>
<span class="c1">#        - a user name</span>
<span class="c1">#        - a group name, with @group syntax</span>
<span class="c1">#        - the wildcard *, for default entry</span>
<span class="c1">#        - the wildcard %, can be also used with %group syntax,</span>
<span class="c1">#                 for maxlogin limit</span>
<span class="c1">#        - NOTE: group and wildcard limits are not applied to root.</span>
<span class="c1">#          To apply a limit to the root user, &lt;domain&gt; must be</span>
<span class="c1">#          the literal username root.</span>
<span class="c1">#</span>
<span class="c1">#&lt;type&gt; can have the two values:</span>
<span class="c1">#        - &quot;soft&quot; for enforcing the soft limits</span>
<span class="c1">#        - &quot;hard&quot; for enforcing hard limits</span>
<span class="c1">#</span>
<span class="c1">#&lt;item&gt; can be one of the following:</span>
<span class="c1">#        - core - limits the core file size (KB)</span>
<span class="c1">#        - data - max data size (KB)</span>
<span class="c1">#        - fsize - maximum filesize (KB)</span>
<span class="c1">#        - memlock - max locked-in-memory address space (KB)</span>
<span class="c1">#        - nofile - max number of open files</span>
<span class="c1">#        - rss - max resident set size (KB)</span>
<span class="c1">#        - stack - max stack size (KB)</span>
<span class="c1">#        - cpu - max CPU time (MIN)</span>
<span class="c1">#        - nproc - max number of processes</span>
<span class="c1">#        - as - address space limit (KB)</span>
<span class="c1">#        - maxlogins - max number of logins for this user</span>
<span class="c1">#        - maxsyslogins - max number of logins on the system</span>
<span class="c1">#        - priority - the priority to run user process with</span>
<span class="c1">#        - locks - max number of file locks the user can hold</span>
<span class="c1">#        - sigpending - max number of pending signals</span>
<span class="c1">#        - msgqueue - max memory used by POSIX message queues (bytes)</span>
<span class="c1">#        - nice - max nice priority allowed to raise to values: [-20, 19]</span>
<span class="c1">#        - rtprio - max realtime priority</span>
<span class="c1">#        - chroot - change root to directory (Debian-specific)</span>
<span class="c1">#</span>
<span class="c1">#&lt;domain&gt;      &lt;type&gt;  &lt;item&gt;         &lt;value&gt;</span>
<span class="c1">#</span>

<span class="c1">#*               soft    core            0</span>
<span class="c1">#root            hard    core            100000</span>
<span class="c1">#*               hard    rss             10000</span>
<span class="c1">#@student        hard    nproc           20</span>
<span class="c1">#@faculty        soft    nproc           20</span>
<span class="c1">#@faculty        hard    nproc           50</span>
<span class="c1">#ftp             hard    nproc           0</span>
<span class="c1">#ftp             -       chroot          /ftp</span>
<span class="c1">#@student        -       maxlogins       4</span>

<span class="c1"># End of file</span>
</pre></div>


<blockquote>
<p>soft limits can be changed by the user but hard limits are the real stop points.</p>
</blockquote>
<h3>checking the users in the system</h3>
<p>If you need to check who is in your system (and to some extend what they are doing) you can use these commands:</p>
<div class="highlight"><pre><span></span>$  w
 <span class="m">22</span>:03:37 up <span class="m">3</span> days,  <span class="m">5</span>:33, <span class="m">13</span> users,  load average: <span class="m">1</span>.48, <span class="m">1</span>.12, <span class="m">1</span>.19
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
jadi     tty7     :0               Wed16    3days  <span class="m">2</span>:30m  <span class="m">1</span>.96s /sbin/upstart --user
jadi     pts/18   :0               Wed16    <span class="m">3</span>:04m  <span class="m">1</span>:02   <span class="m">1</span>:02  /usr/bin/python manage.py runserver <span class="m">0</span>.0.0.0:8000
jadi     pts/19   :0               Wed16    <span class="m">1</span>:11m  <span class="m">0</span>.35s  <span class="m">0</span>.35s /bin/bash
root     tty2                      Wed16    3days  <span class="m">0</span>.07s  <span class="m">0</span>.03s -bash
jadi     pts/21   :0               <span class="m">08</span>:41   <span class="m">45</span>:37   <span class="m">0</span>.06s  <span class="m">0</span>.06s /bin/bash
jadi     pts/23   :0               Thu11   <span class="m">46</span>:49   <span class="m">0</span>.25s  <span class="m">0</span>.23s ssh startups
jadi     pts/21   funlife          Fri22   <span class="m">45</span>:37   <span class="m">0</span>.06s  <span class="m">0</span>.06s /bin/bash
jadi     pts/25   :0               <span class="m">10</span>:17   <span class="m">31</span>:37   <span class="m">0</span>.07s  <span class="m">5</span>.81s /usr/bin/python /usr/bin/x-terminal-emulator
jadi     pts/26   :0               <span class="m">21</span>:39    <span class="m">0</span>.00s  <span class="m">0</span>.07s  <span class="m">0</span>.00s w
jadi     pts/27   :0               <span class="m">21</span>:55    <span class="m">8</span>:09   <span class="m">0</span>.01s  <span class="m">0</span>.01s /bin/bash
</pre></div>


<p>You have a line for each logged in users (every single shell window is a seperated login).</p>
<p>Another userul command is <code>who</code>. Lets check it:</p>
<div class="highlight"><pre><span></span>$ who
jadi     tty7         <span class="m">2016</span>-06-01 <span class="m">16</span>:30 <span class="o">(</span>:0<span class="o">)</span>
jadi     pts/17       <span class="m">2016</span>-06-01 <span class="m">16</span>:30 <span class="o">(</span>funlife<span class="o">)</span>
jadi     pts/2        <span class="m">2016</span>-06-01 <span class="m">16</span>:32 <span class="o">(</span>:0<span class="o">)</span>
jadi     pts/18       <span class="m">2016</span>-06-01 <span class="m">16</span>:32 <span class="o">(</span>:0<span class="o">)</span>
jadi     pts/19       <span class="m">2016</span>-06-01 <span class="m">16</span>:33 <span class="o">(</span>:0<span class="o">)</span>
root     tty2         <span class="m">2016</span>-06-01 <span class="m">16</span>:36
jadi     pts/21       <span class="m">2016</span>-06-04 <span class="m">08</span>:41 <span class="o">(</span>:0<span class="o">)</span>
jadi     pts/22       <span class="m">2016</span>-06-01 <span class="m">18</span>:37 <span class="o">(</span>funlife<span class="o">)</span>
jadi     pts/23       <span class="m">2016</span>-06-02 <span class="m">11</span>:41 <span class="o">(</span>:0<span class="o">)</span>
jadi     pts/21       <span class="m">2016</span>-06-03 <span class="m">22</span>:22 <span class="o">(</span>funlife<span class="o">)</span>
jadi     pts/25       <span class="m">2016</span>-06-04 <span class="m">10</span>:17 <span class="o">(</span>:0<span class="o">)</span>
jadi     pts/26       <span class="m">2016</span>-06-04 <span class="m">21</span>:39 <span class="o">(</span>:0<span class="o">)</span>
jadi     pts/27       <span class="m">2016</span>-06-04 <span class="m">21</span>:55 <span class="o">(</span>:0<span class="o">)</span>
</pre></div>


<p>As you can see both these commands tell you when was the time that the user logged into the system but does not show the logged out people (because they are not on the system anymore!). If you need that data use the <code>last</code> command:</p>
<div class="highlight"><pre><span></span>~$ last | head
jadi     pts/27       :0               Sat Jun  4 21:55    gone - no logout
jadi     pts/26       :0               Sat Jun  4 21:39    gone - no logout
jadi     pts/26       :0               Sat Jun  4 18:55 - 19:42  (00:46)
jadi     pts/25       :0               Sat Jun  4 10:17    gone - no logout
jadi     pts/26       :0               Sat Jun  4 09:25 - 09:26  (00:00)
jadi     pts/26       :0               Sat Jun  4 09:25 - 09:25  (00:00)
jadi     pts/25       :0               Sat Jun  4 08:52 - 09:27  (00:35)
jadi     pts/21       :0               Sat Jun  4 08:41    gone - no logout
jadi     pts/21       funlife          Fri Jun  3 22:22 - 08:41  (10:18)
jadi     pts/21       :0               Fri Jun  3 18:44 - 19:47  (01:03)
</pre></div>


<blockquote>
<p>there is a way to check the failed logins too: <code>last -f /var/log/btmp</code></p>
</blockquote>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
                </div>
                <footer class="text-right">
                    <p></p>
                </footer>
            </div>
        </div>
    </article>
</section>
<footer>
    <hr>
    <div class="row">
        <div class="col-lg-9 text-center">
            <p><small>
                Built by <a href="http://docs.getpelican.com/en/latest">Pelican</a> / <a href="https://github.com/ingwinlu/pelican-twitchy">pelican-twitchy</a>
                &middot;                    &copy; 2015 jadi
            </small></p>
        </div>
    </div>
</footer>            </div>
        </div>
        <!-- /#page-content-wrapper -->
    </div>
    <!-- /#wrapper -->
    <!-- jQuery Version 1.11.2 -->
    <script src="../theme/js/jquery-1.11.2.min.js"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="../theme/js/bootstrap.min.js"></script>
    <!-- twitchy Script -->
    <script src="../theme/js/pelican_twitchy.min.js"></script>

</body>
</html>